<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>xneko - TaskMaster</title>

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Raleway:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">

  <style>
    /* --- CSS Variables & Reset --- */
    :root{
      --bg-body: #ffffff; 
      --text-main: #111827;
      --text-muted: #6b7280;
      --border: #e5e7eb;
    }

    * { box-sizing: border-box; margin: 0; padding: 0; }

    body {
      font-family: 'Raleway', sans-serif;
      background-color: var(--bg-body);
      color: var(--text-main);
      min-height: 100vh;
      position: relative;
      padding-top: 70px;
      padding-bottom: 80px; 
    }

    /* --- GRID BACKGROUND --- */
    .grid-wrapper {
      position: fixed; top: 0; left: 0; width: 100%; height: 100vh; z-index: -1; pointer-events: none; background-color: #ffffff; overflow: hidden;
    }

    .grid-background {
      position: absolute; top: 0; right: 0; bottom: 0; left: 0;
      background-image: 
          linear-gradient(to right, rgba(0, 0, 0, 0.04) 1px, transparent 1px),
          linear-gradient(to bottom, rgba(0, 0, 0, 0.04) 1px, transparent 1px);
      background-size: 20px 20px;
      -webkit-mask-image: linear-gradient(to bottom, black 50%, transparent 100%);
      mask-image: linear-gradient(to bottom, black 50%, transparent 100%);
    }

    /* --- TOP NAVBAR --- */
    .top-nav {
      position: fixed; top: 0; left: 0; width: 100%; height: 60px; 
      display: flex; justify-content: space-between; align-items: center; 
      padding: 0 20px; 
      background: rgba(255,255,255,0.85); backdrop-filter: blur(12px); 
      border-bottom: 1px solid rgba(0,0,0,0.08); z-index: 100;
    }

    .nav-brand {
      font-size: 18px; font-weight: 800; text-transform: uppercase; letter-spacing: 1px;
      text-decoration: none; color: var(--text-main);
    }

    .fb-btn {
      display: flex; align-items: center; text-decoration: none; 
      color: var(--text-main); padding: 5px 12px; 
      background: rgba(0,0,0,0.05); border-radius: 30px; 
      transition: background 0.2s; max-width: 100%; 
    }
    .fb-btn:hover { background: rgba(0,0,0,0.1); }
    .fb-icon-svg { width: 20px; height: 20px; color: #1877F2; margin-right: 8px; flex-shrink: 0; }
    .fb-name { font-size: 14px; font-weight: 600; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }

    .admin-badge {
        font-size: 10px; background: #ff4757; color: white; padding: 2px 6px; 
        border-radius: 4px; text-decoration: none; margin-left: 10px; font-weight: bold;
    }

    /* --- TOP NAV (AUTH ACTIONS) --- */
    .user-actions {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .coin-pill {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      padding: 6px 10px;
      border-radius: 999px;
      background: rgba(0,0,0,0.05);
      border: 1px solid rgba(0,0,0,0.06);
      line-height: 1;
    }

    .coin-icon {
      width: 18px;
      height: 18px;
      color: #f59e0b; /* subtle gold */
      flex-shrink: 0;
    }

    .coin-amount {
      font-size: 13px;
      font-weight: 800;
      color: #111827;
      letter-spacing: 0.2px;
    }

    .icon-btn {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      width: 36px;
      height: 36px;
      border-radius: 999px;
      background: rgba(0,0,0,0.05);
      border: 1px solid rgba(0,0,0,0.06);
      color: var(--text-main);
      text-decoration: none;
      transition: background 0.2s, transform 0.2s;
    }

    .icon-btn:hover {
      background: rgba(0,0,0,0.10);
      transform: translateY(-1px);
    }

    .icon-btn:active {
      transform: translateY(0);
    }

    .icon-btn:focus-visible {
      outline: 2px solid #2563eb;
      outline-offset: 2px;
    }

    .icon-svg {
      width: 20px;
      height: 20px;
      flex-shrink: 0;
    }

    /* --- BOTTOM NAVBAR --- */
    .bottom-nav {
      position: fixed; bottom: 0; left: 0; width: 100%; height: 70px;
      background: rgba(255,255,255,0.95); backdrop-filter: blur(10px);
      border-top: 1px solid rgba(0,0,0,0.1);
      display: flex; justify-content: space-around; align-items: center;
      padding: 0 10px; z-index: 100;
    }

    .nav-item {
      display: flex; flex-direction: column; align-items: center;
      text-decoration: none; color: #94a3b8; width: 25%; transition: color 0.3s ease;
    }
    .nav-item.active { color: #111827; } 
    .nav-item.active .nav-icon-svg { transform: scale(1.1); transition: transform 0.2s; }
    .nav-icon-svg { width: 24px; height: 24px; margin-bottom: 4px; }
    .nav-text { font-size: 11px; font-weight: 600; } 

    /* --- CONTENT --- */
    .main-container { max-width: 800px; margin: 0 auto; padding: 0 20px; }
    .alert { padding: 12px 15px; margin-bottom: 20px; border-radius: 8px; background-color: #d1ecf1; color: #0c5460; border: 1px solid #bee5eb; font-size: 14px; font-weight: 500; }

    /* Global Styles */
    .btn { display: inline-block; padding: 8px 16px; background-color: #007bff; color: white; text-decoration: none; border-radius: 4px; border: none; cursor: pointer; font-size: 14px; transition: background 0.3s; }
    .btn:hover { background-color: #0056b3; }
    table { width: 100%; border-collapse: collapse; margin-top: 20px; }
    th, td { padding: 12px 15px; border-bottom: 1px solid #ddd; text-align: left; }
    th { background-color: #f8f9fa; font-weight: 600; color: #555; }

    .status-confirmed, .status-approved { color: #28a745; font-weight: bold; }
    .status-declined, .status-rejected { color: #dc3545; font-weight: bold; }
    .status-pending { color: #e67e22; font-weight: bold; }

  </style>
</head>

<body>

  <div class="grid-wrapper"><div class="grid-background"></div></div>

  <div class="top-nav">
    <div style="display: flex; align-items: center;">
        <a href="/" class="nav-brand">xneko</a>
        {% if current_user.is_authenticated and current_user.is_admin %}
            <a href="{{ url_for('admin_panel') }}" class="admin-badge">ADMIN</a>
        {% endif %}
    </div>

    {% if current_user.is_authenticated %}
        <div class="user-actions">
            <div class="coin-pill" title="Coins" aria-label="Coins">
              <!-- Coin Icon -->
              <svg class="coin-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
                <circle cx="12" cy="12" r="9"></circle>
                <path d="M14 9a2 2 0 0 0-2-2h-1a2 2 0 0 0 0 4h2a2 2 0 0 1 0 4h-1a2 2 0 0 1-2-2"></path>
                <path d="M12 7v2"></path>
                <path d="M12 15v2"></path>
              </svg>
              <span class="coin-amount">{{ current_user.coins }}</span>
            </div>

            <a href="{{ url_for('logout') }}" class="icon-btn" title="Logout" aria-label="Logout">
              <!-- Logout Icon -->
              <svg class="icon-svg" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true">
                <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 9V5.25A2.25 2.25 0 0 0 13.5 3h-6A2.25 2.25 0 0 0 5.25 5.25v13.5A2.25 2.25 0 0 0 7.5 21h6a2.25 2.25 0 0 0 2.25-2.25V15" />
                <path stroke-linecap="round" stroke-linejoin="round" d="M18 12H9m9 0-3-3m3 3-3 3" />
              </svg>
            </a>
        </div>
    {% else %}
        <a href="https://www.facebook.com/theeliteman" target="_blank" class="fb-btn">
        <svg class="fb-icon-svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
            <path d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"/>
        </svg>
        <span class="fb-name">Mahfuz Ahmed</span>
        </a>
    {% endif %}
  </div>

  <div class="main-container">
      {% with messages = get_flashed_messages() %}
          {% if messages %}
              {% for message in messages %}<div class="alert">{{ message }}</div>{% endfor %}
          {% endif %}
      {% endwith %}
      {% block content %}{% endblock %}
  </div>

  {% if current_user.is_authenticated %}
  <nav class="bottom-nav">
    <a href="{{ url_for('dashboard') }}" class="nav-item {{ 'active' if request.endpoint == 'dashboard' else '' }}">
      <svg class="nav-icon-svg" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M2.25 12l8.954-8.955c.44-.439 1.152-.439 1.591 0L21.75 12M4.5 9.75v10.125c0 .621.504 1.125 1.125 1.125H9.75v-4.875c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125V21h4.125c.621 0 1.125-.504 1.125-1.125V9.75M8.25 21h8.25" /></svg>
      <span class="nav-text">Home</span>
    </a>
    <a href="{{ url_for('submit_task') }}" class="nav-item {{ 'active' if request.endpoint == 'submit_task' else '' }}">
      <svg class="nav-icon-svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 48"><path fill="#4caf50" d="M45,16.2l-5,2.75l-5,4.75L35,40h7c1.657,0,3-1.343,3-3V16.2z"></path><path fill="#1e88e5" d="M3,16.2l3.614,1.71L13,23.7V40H6c-1.657,0-3-1.343-3-3V16.2z"></path><polygon fill="#e53935" points="35,11.2 24,19.45 13,11.2 12,17 13,23.7 24,31.95 35,23.7 36,17"></polygon><path fill="#c62828" d="M3,12.298V16.2l10,7.5V11.2L9.876,8.859C9.132,8.301,8.228,8,7.298,8h0C4.924,8,3,9.924,3,12.298z"></path><path fill="#fbc02d" d="M45,12.298V16.2l-10,7.5V11.2l3.124-2.341C38.868,8.301,39.772,8,40.702,8h0 C43.076,8,45,9.924,45,12.298z"></path></svg>
      <span class="nav-text">Submit</span>
    </a>
    <a href="{{ url_for('my_tasks') }}" class="nav-item {{ 'active' if request.endpoint == 'my_tasks' else '' }}">
      <svg class="nav-icon-svg" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M9 12h3.75M9 15h3.75M9 18h3.75m3 .75H18a2.25 2.25 0 002.25-2.25V6.108c0-1.135-.845-2.098-1.976-2.192a48.424 48.424 0 00-1.123-.08m-5.801 0c-.065.21-.1.433-.1.664 0 1.414 1.146 2.56 2.56 2.56 1.415 0 2.56-1.146 2.56-2.56a2.573 2.573 0 00-.1-.664m-5.8 0c-.376.023-.75.05-1.124.08C9.095 4.01 8.25 4.973 8.25 6.108V8.25m0 0H4.875c-.621 0-1.125.504-1.125 1.125v11.25c0 .621.504 1.125 1.125 1.125h9.75c.621 0 1.125-.504 1.125-1.125V9.375c0-.621-.504-1.125-1.125-1.125H8.25zM6.75 12h.008v.008H6.75V12zm0 3h.008v.008H6.75V15zm0 3h.008v.008H6.75V18z" /></svg>
      <span class="nav-text">Tasks</span>
    </a>
    <a href="{{ url_for('withdraw') }}" class="nav-item {{ 'active' if request.endpoint == 'withdraw' else '' }}">
      <svg class="nav-icon-svg" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M21 12a2.25 2.25 0 00-2.25-2.25H15a3 3 0 11-6 0H5.25A2.25 2.25 0 003 12m18 0v6a2.25 2.25 0 01-2.25 2.25H5.25A2.25 2.25 0 013 18v-6m18 0V9M3 12V9m18 0a2.25 2.25 0 00-2.25-2.25H5.25A2.25 2.25 0 003 9m18 0V6a2.25 2.25 0 00-2.25-2.25H5.25A2.25 2.25 0 003 6v3" /></svg>
      <span class="nav-text">Withdraw</span>
    </a>
  </nav>
  {% endif %}
</body>
</html>
